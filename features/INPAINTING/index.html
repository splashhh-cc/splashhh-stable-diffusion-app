
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="mauwii">
      
      
        <link rel="canonical" href="https://invoke-ai.github.io/InvokeAI/features/INPAINTING/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Inpainting - InvokeAI Stable Diffusion Toolkit Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#inpainting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="InvokeAI Stable Diffusion Toolkit Docs" class="md-header__button md-logo" aria-label="InvokeAI Stable Diffusion Toolkit Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            InvokeAI Stable Diffusion Toolkit Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Inpainting
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/invoke-ai/InvokeAI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    invoke-ai/InvokeAI
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../CHANGELOG/" class="md-tabs__link">
      Changelog
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Features
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../help/SAMPLER_CONVERGENCE/" class="md-tabs__link">
        Help
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        Installation
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../other/CONTRIBUTORS/" class="md-tabs__link">
        Other
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="InvokeAI Stable Diffusion Toolkit Docs" class="md-nav__button md-logo" aria-label="InvokeAI Stable Diffusion Toolkit Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    InvokeAI Stable Diffusion Toolkit Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/invoke-ai/InvokeAI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    invoke-ai/InvokeAI
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../CHANGELOG/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Features" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CLI/" class="md-nav__link">
        Command-Line Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CONCEPTS/" class="md-nav__link">
        Concepts Library
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../EMBIGGEN/" class="md-nav__link">
        Embiggen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../IMG2IMG/" class="md-nav__link">
        Image-to-Image
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Inpainting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Inpainting
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-transparent-regions-for-inpainting" class="md-nav__link">
    Creating Transparent Regions for Inpainting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#masking-using-text" class="md-nav__link">
    Masking using Text
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-runwayml-inpainting-model" class="md-nav__link">
    Using the RunwayML inpainting model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inpainting-is-not-changing-the-masked-region-enough" class="md-nav__link">
    Inpainting is not changing the masked region enough!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-for-gimp" class="md-nav__link">
    Recipe for GIMP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-for-adobe-photoshop" class="md-nav__link">
    Recipe for Adobe Photoshop
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MODEL_MERGING/" class="md-nav__link">
        Model Merging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../NSFW/" class="md-nav__link">
        The NSFW Checker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../OTHER/" class="md-nav__link">
        Others
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../OUTPAINTING/" class="md-nav__link">
        Outpainting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../POSTPROCESS/" class="md-nav__link">
        Postprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../PROMPTS/" class="md-nav__link">
        Prompting-Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TEXTUAL_INVERSION/" class="md-nav__link">
        Textual-Inversion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UNIFIED_CANVAS/" class="md-nav__link">
        Unified Canvas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../VARIATIONS/" class="md-nav__link">
        Variations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../WEB/" class="md-nav__link">
        InvokeAI Web Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../WEBUIHOTKEYS/" class="md-nav__link">
        WebUI Hotkey List
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Help
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Help" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Help
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../help/SAMPLER_CONVERGENCE/" class="md-nav__link">
        Sampler Convergence
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Deprecated
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deprecated" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Deprecated
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../help/deprecated/TROUBLESHOOT/" class="md-nav__link">
        F.A.Q.
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installation" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/010_INSTALL_AUTOMATED/" class="md-nav__link">
        Installing with the Automated Installer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/020_INSTALL_MANUAL/" class="md-nav__link">
        Installing Manually
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/030_INSTALL_CUDA_AND_ROCM/" class="md-nav__link">
        NVIDIA Cuda / AMD ROCm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/040_INSTALL_DOCKER/" class="md-nav__link">
        Installing with Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/050_INSTALLING_MODELS/" class="md-nav__link">
        Installing Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/060_INSTALL_PATCHMATCH/" class="md-nav__link">
        Installing PyPatchMatch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/070_INSTALL_XFORMERS/" class="md-nav__link">
        Installing xFormers
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_9" type="checkbox" id="__nav_5_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_9">
          Developers documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developers documentation" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_9">
          <span class="md-nav__icon md-icon"></span>
          Developers documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/Developers_documentation/BUILDING_BINARY_INSTALLERS/" class="md-nav__link">
        build binary installers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_10" type="checkbox" id="__nav_5_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_10">
          Deprecated documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deprecated documentation" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_10">
          <span class="md-nav__icon md-icon"></span>
          Deprecated documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/deprecated_documentation/INSTALL_BINARY/" class="md-nav__link">
        InvokeAI Binary Installer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/deprecated_documentation/INSTALL_JUPYTER/" class="md-nav__link">
        Running InvokeAI on Google Colab using a Jupyter Notebook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/deprecated_documentation/INSTALL_LINUX/" class="md-nav__link">
        Manual Installation, Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/deprecated_documentation/INSTALL_MAC/" class="md-nav__link">
        Manual Installation, macOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/deprecated_documentation/INSTALL_PCP/" class="md-nav__link">
        Installing InvokeAI with the Pre-Compiled PIP Installer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/deprecated_documentation/INSTALL_SOURCE/" class="md-nav__link">
        Source Installer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/deprecated_documentation/INSTALL_WINDOWS/" class="md-nav__link">
        Manual Installation, Windows
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/CONTRIBUTORS/" class="md-nav__link">
        Contributors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/README-CompViz/" class="md-nav__link">
        CompViz-Readme
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/invoke-ai/InvokeAI/edit/main/docs/features/INPAINTING.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 12h8v2H8v-2m2 8H6V4h7v5h5v3.1l2-2V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4v-2m-2-2h4.1l.9-.9V16H8v2m12.2-5c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
  </a>


<h1 id="inpainting"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.134 1.535C9.722 2.562 8.16 4.057 6.889 5.312 5.8 6.387 5.041 7.401 4.575 8.294a3.745 3.745 0 0 0-3.227 1.054c-.43.431-.69 1.066-.86 1.657a11.982 11.982 0 0 0-.358 1.914A21.263 21.263 0 0 0 0 15.203v.054l.75-.007-.007.75h.054a14.404 14.404 0 0 0 .654-.012 21.243 21.243 0 0 0 1.63-.118c.62-.07 1.3-.18 1.914-.357.592-.17 1.226-.43 1.657-.861a3.745 3.745 0 0 0 1.055-3.217c.908-.461 1.942-1.216 3.04-2.3 1.279-1.262 2.764-2.825 3.775-4.249.501-.706.923-1.428 1.125-2.096.2-.659.235-1.469-.368-2.07-.606-.607-1.42-.55-2.069-.34-.66.213-1.376.646-2.076 1.155zm-3.95 8.48a3.76 3.76 0 0 0-1.19-1.192 9.758 9.758 0 0 1 1.161-1.607l1.658 1.658a9.853 9.853 0 0 1-1.63 1.142zM.742 16l.007-.75-.75.008A.75.75 0 0 0 .743 16zM12.016 2.749c-1.224.89-2.605 2.189-3.822 3.384l1.718 1.718c1.21-1.205 2.51-2.597 3.387-3.833.47-.662.78-1.227.912-1.662.134-.444.032-.551.009-.575h-.001V1.78c-.014-.014-.112-.113-.548.027-.432.14-.995.462-1.655.942zM1.62 13.089a19.56 19.56 0 0 0-.104 1.395 19.55 19.55 0 0 0 1.396-.104 10.528 10.528 0 0 0 1.668-.309c.526-.151.856-.325 1.011-.48a2.25 2.25 0 0 0-3.182-3.182c-.155.155-.329.485-.48 1.01a10.515 10.515 0 0 0-.309 1.67z"/></svg></span> Inpainting<a class="headerlink" href="#inpainting" title="Permanent link">#</a></h1>
<h2 id="creating-transparent-regions-for-inpainting"><strong>Creating Transparent Regions for Inpainting</strong><a class="headerlink" href="#creating-transparent-regions-for-inpainting" title="Permanent link">#</a></h2>
<p>Inpainting is really cool. To do it, you start with an initial image and use a
photoeditor to make one or more regions transparent (i.e. they have a "hole" in
them). You then provide the path to this image at the dream&gt; command line using
the <code>-I</code> switch. Stable Diffusion will only paint within the transparent region.</p>
<p>There's a catch. In the current implementation, you have to prepare the initial
image correctly so that the underlying colors are preserved under the
transparent area. Many imaging editing applications will by default erase the
color information under the transparent pixels and replace them with white or
black, which will lead to suboptimal inpainting. It often helps to apply
incomplete transparency, such as any value between 1 and 99%</p>
<p>You also must take care to export the PNG file in such a way that the color
information is preserved. There is often an option in the export dialog that
lets you specify this.</p>
<p>If your photoeditor is erasing the underlying color information, <code>dream.py</code> will
give you a big fat warning. If you can't find a way to coax your photoeditor to
retain color values under transparent areas, then you can combine the <code>-I</code> and
<code>-M</code> switches to provide both the original unedited image and the masked
(partially transparent) image:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>invoke&gt;<span class="w"> </span><span class="s2">&quot;man with cat on shoulder&quot;</span><span class="w"> </span>-I./images/man.png<span class="w"> </span>-M./images/man-transparent.png
</code></pre></div>
<h2 id="masking-using-text"><strong>Masking using Text</strong><a class="headerlink" href="#masking-using-text" title="Permanent link">#</a></h2>
<p>You can also create a mask using a text prompt to select the part of the image
you want to alter, using the <a href="https://github.com/timojl/clipseg">clipseg</a>
algorithm. This works on any image, not just ones generated by InvokeAI.</p>
<p>The <code>--text_mask</code> (short form <code>-tm</code>) option takes two arguments. The first
argument is a text description of the part of the image you wish to mask (paint
over). If the text description contains a space, you must surround it with
quotation marks. The optional second argument is the minimum threshold for the
mask classifier's confidence score, described in more detail below.</p>
<p>To see how this works in practice, here's an image of a still life painting that
I got off the web.</p>
<figure>
<p><img alt="still life scaled" src="../../assets/still-life-scaled.jpg" /></p>
</figure>
<p>You can selectively mask out the orange and replace it with a baseball in this
way:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>invoke&gt;<span class="w"> </span>a<span class="w"> </span>baseball<span class="w"> </span>-I<span class="w"> </span>/path/to/still_life.png<span class="w"> </span>-tm<span class="w"> </span>orange
</code></pre></div>
<figure>
<p><img alt="" src="../../assets/still-life-inpainted.png" /></p>
</figure>
<p>The clipseg classifier produces a confidence score for each region it
identifies. Generally regions that score above 0.5 are reliable, but if you are
getting too much or too little masking you can adjust the threshold down (to get
more mask), or up (to get less). In this example, by passing <code>-tm</code> a higher
value, we are insisting on a tigher mask. However, if you make it too high, the
orange may not be picked up at all!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>invoke&gt;<span class="w"> </span>a<span class="w"> </span>baseball<span class="w"> </span>-I<span class="w"> </span>/path/to/breakfast.png<span class="w"> </span>-tm<span class="w"> </span>orange<span class="w"> </span><span class="m">0</span>.6
</code></pre></div>
<p>The <code>!mask</code> command may be useful for debugging problems with the text2mask
feature. The syntax is <code>!mask /path/to/image.png -tm &lt;text&gt; &lt;threshold&gt;</code></p>
<p>It will generate three files:</p>
<ul>
<li>The image with the selected area highlighted.</li>
<li>it will be named XXXXX.<imagename>.<prompt>.selected.png</li>
<li>The image with the un-selected area highlighted.</li>
<li>it will be named XXXXX.<imagename>.<prompt>.deselected.png</li>
<li>The image with the selected area converted into a black and white image
  according to the threshold level</li>
<li>it will be named XXXXX.<imagename>.<prompt>.masked.png</li>
</ul>
<p>The <code>.masked.png</code> file can then be directly passed to the <code>invoke&gt;</code> prompt in
the CLI via the <code>-M</code> argument. Do not attempt this with the <code>selected.png</code> or
<code>deselected.png</code> files, as they contain some transparency throughout the image
and will not produce the desired results.</p>
<p>Here is an example of how <code>!mask</code> works:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>invoke&gt;<span class="w"> </span>!mask<span class="w"> </span>./test-pictures/curly.png<span class="w"> </span>-tm<span class="w"> </span>hair<span class="w"> </span><span class="m">0</span>.5
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>&gt;&gt;<span class="w"> </span>generating<span class="w"> </span>masks<span class="w"> </span>from<span class="w"> </span>./test-pictures/curly.png
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>&gt;&gt;<span class="w"> </span>Initializing<span class="w"> </span>clipseg<span class="w"> </span>model<span class="w"> </span><span class="k">for</span><span class="w"> </span>text<span class="w"> </span>to<span class="w"> </span>mask<span class="w"> </span>inference
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>Outputs:
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="o">[</span><span class="m">941</span>.1<span class="o">]</span><span class="w"> </span>outputs/img-samples/000019.curly.hair.deselected.png:<span class="w"> </span>!mask<span class="w"> </span>./test-pictures/curly.png<span class="w"> </span>-tm<span class="w"> </span>hair<span class="w"> </span><span class="m">0</span>.5
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="o">[</span><span class="m">941</span>.2<span class="o">]</span><span class="w"> </span>outputs/img-samples/000019.curly.hair.selected.png:<span class="w"> </span>!mask<span class="w"> </span>./test-pictures/curly.png<span class="w"> </span>-tm<span class="w"> </span>hair<span class="w"> </span><span class="m">0</span>.5
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="o">[</span><span class="m">941</span>.3<span class="o">]</span><span class="w"> </span>outputs/img-samples/000019.curly.hair.masked.png:<span class="w"> </span>!mask<span class="w"> </span>./test-pictures/curly.png<span class="w"> </span>-tm<span class="w"> </span>hair<span class="w"> </span><span class="m">0</span>.5
</code></pre></div>
<figure>
<p><img alt="curly" src="../../assets/outpainting/curly.png" /></p>
<figcaption>Original image "curly.png"</figcaption>
</figure>
<figure>
<p><img alt="curly hair selected" src="../../assets/inpainting/000019.curly.hair.selected.png" /></p>
<figcaption>000019.curly.hair.selected.png</figcaption>
</figure>
<figure>
<p><img alt="curly hair deselected" src="../../assets/inpainting/000019.curly.hair.deselected.png" /></p>
<figcaption>000019.curly.hair.deselected.png</figcaption>
</figure>
<figure>
<p><img alt="curly hair masked" src="../../assets/inpainting/000019.curly.hair.masked.png" /></p>
<figcaption>000019.curly.hair.masked.png</figcaption>
</figure>
<p>It looks like we selected the hair pretty well at the 0.5 threshold (which is
the default, so we didn't actually have to specify it), so let's have some fun:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>invoke&gt;<span class="w"> </span>medusa<span class="w"> </span>with<span class="w"> </span>cobras<span class="w"> </span>-I<span class="w"> </span>./test-pictures/curly.png<span class="w"> </span>-M<span class="w"> </span><span class="m">000019</span>.curly.hair.masked.png<span class="w"> </span>-C20
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>&gt;&gt;<span class="w"> </span>loaded<span class="w"> </span>input<span class="w"> </span>image<span class="w"> </span>of<span class="w"> </span>size<span class="w"> </span>512x512<span class="w"> </span>from<span class="w"> </span>./test-pictures/curly.png
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>...
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>Outputs:
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="o">[</span><span class="m">946</span><span class="o">]</span><span class="w"> </span>outputs/img-samples/000024.801380492.png:<span class="w"> </span><span class="s2">&quot;medusa with cobras&quot;</span><span class="w"> </span>-s<span class="w"> </span><span class="m">50</span><span class="w"> </span>-S<span class="w"> </span><span class="m">801380492</span><span class="w"> </span>-W<span class="w"> </span><span class="m">512</span><span class="w"> </span>-H<span class="w"> </span><span class="m">512</span><span class="w"> </span>-C<span class="w"> </span><span class="m">20</span>.0<span class="w"> </span>-I<span class="w"> </span>./test-pictures/curly.png<span class="w"> </span>-A<span class="w"> </span>k_lms<span class="w"> </span>-f<span class="w"> </span><span class="m">0</span>.75
</code></pre></div>
<figure>
<p><img alt="" src="../../assets/inpainting/000024.801380492.png" /></p>
</figure>
<p>You can also skip the <code>!mask</code> creation step and just select the masked</p>
<p>region directly:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>invoke&gt;<span class="w"> </span>medusa<span class="w"> </span>with<span class="w"> </span>cobras<span class="w"> </span>-I<span class="w"> </span>./test-pictures/curly.png<span class="w"> </span>-tm<span class="w"> </span>hair<span class="w"> </span>-C20
</code></pre></div>
<h2 id="using-the-runwayml-inpainting-model">Using the RunwayML inpainting model<a class="headerlink" href="#using-the-runwayml-inpainting-model" title="Permanent link">#</a></h2>
<p>The
<a href="https://huggingface.co/runwayml/stable-diffusion-inpainting">RunwayML Inpainting Model v1.5</a>
is a specialized version of
<a href="https://huggingface.co/spaces/runwayml/stable-diffusion-v1-5">Stable Diffusion v1.5</a>
that contains extra channels specifically designed to enhance inpainting and
outpainting. While it can do regular <code>txt2img</code> and <code>img2img</code>, it really shines
when filling in missing regions. It has an almost uncanny ability to blend the
new regions with existing ones in a semantically coherent way.</p>
<p>To install the inpainting model, follow the
<a href="../../installation/050_INSTALLING_MODELS/">instructions</a> for installing a new model.
You may use either the CLI (<code>invoke.py</code> script) or directly edit the
<code>configs/models.yaml</code> configuration file to do this. The main thing to watch out
for is that the the model <code>config</code> option must be set up to use
<code>v1-inpainting-inference.yaml</code> rather than the <code>v1-inference.yaml</code> file that is
used by Stable Diffusion 1.4 and 1.5.</p>
<p>After installation, your <code>models.yaml</code> should contain an entry that looks like
this one:</p>
<p>inpainting-1.5: weights: models/ldm/stable-diffusion-v1/sd-v1-5-inpainting.ckpt
description: SD inpainting v1.5 config:
configs/stable-diffusion/v1-inpainting-inference.yaml vae:
models/ldm/stable-diffusion-v1/vae-ft-mse-840000-ema-pruned.ckpt width: 512
height: 512</p>
<p>As shown in the example, you may include a VAE fine-tuning weights file as well.
This is strongly recommended.</p>
<p>To use the custom inpainting model, launch <code>invoke.py</code> with the argument
<code>--model inpainting-1.5</code> or alternatively from within the script use the
<code>!switch inpainting-1.5</code> command to load and switch to the inpainting model.</p>
<p>You can now do inpainting and outpainting exactly as described above, but there
will (likely) be a noticeable improvement in coherence. Txt2img and Img2img will
work as well.</p>
<p>There are a few caveats to be aware of:</p>
<ol>
<li>
<p>The inpainting model is larger than the standard model, and will use nearly 4
   GB of GPU VRAM. This makes it unlikely to run on a 4 GB graphics card.</p>
</li>
<li>
<p>When operating in Img2img mode, the inpainting model is much less steerable
   than the standard model. It is great for making small changes, such as
   changing the pattern of a fabric, or slightly changing a subject's expression
   or hair, but the model will resist making the dramatic alterations that the
   standard model lets you do.</p>
</li>
<li>
<p>While the <code>--hires</code> option works fine with the inpainting model, some special
   features, such as <code>--embiggen</code> are disabled.</p>
</li>
<li>
<p>Prompt weighting (<code>banana++ sushi</code>) and merging work well with the inpainting
   model, but prompt swapping
   (<code>a ("fluffy cat").swap("smiling dog") eating a hotdog</code>) will not have any
   effect due to the way the model is set up. You may use text masking (with
   <code>-tm thing-to-mask</code>) as an effective replacement.</p>
</li>
<li>
<p>The model tends to oversharpen image if you use high step or CFG values. If
   you need to do large steps, use the standard model.</p>
</li>
<li>
<p>The <code>--strength</code> (<code>-f</code>) option has no effect on the inpainting model due to
   its fundamental differences with the standard model. It will always take the
   full number of steps you specify.</p>
</li>
</ol>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">#</a></h2>
<p>Here are some troubleshooting tips for inpainting and outpainting.</p>
<h2 id="inpainting-is-not-changing-the-masked-region-enough">Inpainting is not changing the masked region enough!<a class="headerlink" href="#inpainting-is-not-changing-the-masked-region-enough" title="Permanent link">#</a></h2>
<p>One of the things to understand about how inpainting works is that it is
equivalent to running img2img on just the masked (transparent) area. img2img
builds on top of the existing image data, and therefore will attempt to preserve
colors, shapes and textures to the best of its ability. Unfortunately this means
that if you want to make a dramatic change in the inpainted region, for example
replacing a red wall with a blue one, the algorithm will fight you.</p>
<p>You have a couple of options. The first is to increase the values of the
requested steps (<code>-sXXX</code>), strength (<code>-f0.XX</code>), and/or condition-free guidance
(<code>-CXX.X</code>). If this is not working for you, a more extreme step is to provide
the <code>--inpaint_replace 0.X</code> (<code>-r0.X</code>) option. This value ranges from 0.0 to 1.0.
The higher it is the less attention the algorithm will pay to the data
underneath the masked region. At high values this will enable you to replace
colored regions entirely, but beware that the masked region mayl not blend in
with the surrounding unmasked regions as well.</p>
<hr />
<h2 id="recipe-for-gimp">Recipe for GIMP<a class="headerlink" href="#recipe-for-gimp" title="Permanent link">#</a></h2>
<p><a href="https://www.gimp.org/">GIMP</a> is a popular Linux photoediting tool.</p>
<ol>
<li>Open image in GIMP.</li>
<li>Layer-&gt;Transparency-&gt;Add Alpha Channel</li>
<li>Use lasso tool to select region to mask</li>
<li>Choose Select -&gt; Float to create a floating selection</li>
<li>Open the Layers toolbar (^L) and select "Floating Selection"</li>
<li>Set opacity to a value between 0% and 99%</li>
<li>Export as PNG</li>
<li>In the export dialogue, Make sure the "Save colour values from transparent
   pixels" checkbox is selected.</li>
</ol>
<hr />
<h2 id="recipe-for-adobe-photoshop">Recipe for Adobe Photoshop<a class="headerlink" href="#recipe-for-adobe-photoshop" title="Permanent link">#</a></h2>
<ol>
<li>
<p>Open image in Photoshop</p>
<p><figure markdown>
<img alt="step1" src="../../assets/step1.png" />
</figure></p>
</li>
<li>
<p>Use any of the selection tools (Marquee, Lasso, or Wand) to select the area
   you desire to inpaint.</p>
<p><figure markdown>
<img alt="step2" src="../../assets/step2.png" />
</figure></p>
</li>
<li>
<p>Because we'll be applying a mask over the area we want to preserve, you
   should now select the inverse by using the <span class="keys"><kbd class="key-shift">Shift</kbd><span>+</span><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-i">I</kbd></span> shortcut, or
   right clicking and using the "Select Inverse" option.</p>
</li>
<li>
<p>You'll now create a mask by selecting the image layer, and Masking the
   selection. Make sure that you don't delete any of the underlying image, or
   your inpainting results will be dramatically impacted.</p>
<p><figure markdown>
<img alt="step4" src="../../assets/step4.png" />
</figure></p>
</li>
<li>
<p>Make sure to hide any background layers that are present. You should see the
   mask applied to your image layer, and the image on your canvas should display
   the checkered background.</p>
<p><figure markdown>
<img alt="step5" src="../../assets/step5.png" />
</figure></p>
</li>
<li>
<p>Save the image as a transparent PNG by using <code>File</code>&rarr;<code>Save a Copy</code> from the
   menu bar, or by using the keyboard shortcut <span class="keys"><kbd class="key-alt">Alt</kbd><span>+</span><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-s">S</kbd></span></p>
<p><figure markdown>
<img alt="step6" src="../../assets/step6.png" />
</figure></p>
</li>
<li>
<p>After following the inpainting instructions above (either through the CLI or
   the Web UI), marvel at your newfound ability to selectively invoke. Lookin'
   good!</p>
<p><figure markdown>
   <img alt="step7" src="../../assets/step7.png" />
</figure></p>
</li>
<li>
<p>In the export dialogue, Make sure the "Save colour values from transparent
   pixels" checkbox is selected.</p>
</li>
</ol>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 15, 2022</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 11, 2022</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../IMG2IMG/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Image-to-Image" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Image-to-Image
            </div>
          </div>
        </a>
      
      
        
        <a href="../MODEL_MERGING/" class="md-footer__link md-footer__link--next" aria-label="Next: Model Merging" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Model Merging
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 InvokeAI Team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.suggest", "toc.integrate"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>